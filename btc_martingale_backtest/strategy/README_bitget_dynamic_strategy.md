# ë¹„íŠ¸ê²Ÿ ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ BTC ë¬¼íƒ€ê¸° ì „ëµ

## ê°œìš”
ì´ ì „ëµì€ **ë¹„íŠ¸ê²Ÿ ê±°ë˜ì†Œì˜ ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ ì²­ì‚°ê°€ ê³„ì‚° ê³µì‹**ì„ ì ìš©í•œ Pine Script ì „ëµì…ë‹ˆë‹¤. ê¸°ì¡´ì˜ í•˜ë“œì½”ë”©ëœ ë§ˆì§„ ë¹„ìœ¨ ëŒ€ì‹ , ì§„ì… íšŸìˆ˜ì— ë”°ë¥¸ ë™ì  ë ˆë²„ë¦¬ì§€ ê³„ì‚°ìœ¼ë¡œ ì •í™•í•˜ê³  ìœ ì—°í•œ ì²­ì‚°ê°€ ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ íŠ¹ì§•

### 1. **í•˜ë“œì½”ë”© ì™„ì „ ì œê±°**
- âŒ ê¸°ì¡´: `entry_count == 3 ? 0.30 : entry_count == 4 ? 0.6143 : ...`
- âœ… ìƒˆë¡œìš´: `(leverage Ã— entry_count) / divided_count` ë™ì  ê³„ì‚°

### 2. **ë¹„íŠ¸ê²Ÿ ê³µì‹ ê¸°ë°˜ ì²­ì‚°ê°€ ê³„ì‚°**
- **ë™ì  ë ˆë²„ë¦¬ì§€ ê³µì‹**: `ìœ íš¨ë ˆë²„ë¦¬ì§€ = (ê¸°ë³¸ë ˆë²„ë¦¬ì§€ Ã— ì§„ì…íšŸìˆ˜) / ì‹œë“œë¶„í• `
- **ì²­ì‚°ê°€ ê³µì‹**: `ì²­ì‚°ê°€ = í‰ê· ê°€ Ã— (1 - 1/ìœ íš¨ë ˆë²„ë¦¬ì§€)`
- **ê²€ì¦ ê²°ê³¼**: 4ë²ˆì§¸ ì§„ì… ì‹œ ì²­ì‚°ê°€ 59,893.26 (ëª©í‘œ 60,603.03ê³¼ 709.77 ì°¨ì´)

### 3. **ì§„ì… íšŸìˆ˜ë³„ ì•ˆì „ì„± ê´€ë¦¬**
- **1-2ë²ˆ ì§„ì…**: ì²­ì‚°ê°€ ì—†ìŒ (ì•ˆì „ êµ¬ê°„)
- **3ë²ˆì§¸ ì§„ì…ë¶€í„°**: ë™ì  ë ˆë²„ë¦¬ì§€ë¡œ ì²­ì‚°ê°€ ê³„ì‚°
- **Partial Exit í›„**: entryCountë¥¼ 1ë¡œ ë¦¬ì…‹í•˜ì—¬ ì²­ì‚°ê°€ ì œê±°

## ğŸ”§ í•µì‹¬ í•¨ìˆ˜ë“¤

### ë¹„íŠ¸ê²Ÿ ì²­ì‚°ê°€ ê³„ì‚°
```pinescript
calculate_bitget_liquidation_price(avg_price, entry_count, leverage, divided_count) =>
    if entry_count <= 2
        na
    else
        // ë¹„íŠ¸ê²Ÿ ë™ì  ë ˆë²„ë¦¬ì§€ ê³µì‹
        effective_leverage = (leverage * entry_count) / divided_count
        
        if effective_leverage < 1.0
            na
        else
            // ë¹„íŠ¸ê²Ÿ ì²­ì‚°ê°€ ê³µì‹: í‰ê· ê°€ Ã— (1 - 1/ìœ íš¨ë ˆë²„ë¦¬ì§€)
            liq_price = avg_price * (1 - 1/effective_leverage)
            math.max(liq_price, 0)
```

### ë™ì  ë ˆë²„ë¦¬ì§€ ê³„ì‚°
```pinescript
calculate_effective_leverage(entry_count, leverage, divided_count) =>
    if entry_count <= 0 or leverage <= 0 or divided_count <= 0
        0.0
    else
        (leverage * entry_count) / divided_count
```

## ğŸ“Š ê²€ì¦ ê²°ê³¼

ì œê³µëœ ì§„ì…ê°€ ë°ì´í„°ë¡œ ê²€ì¦í•œ ê²°ê³¼:

| ì§„ì… íšŸìˆ˜ | ì§„ì…ê°€ | í‰ë‹¨ê°€ | ìœ íš¨ë ˆë²„ë¦¬ì§€ | ì²­ì‚°ê°€ | ëª©í‘œì™€ ì°¨ì´ |
|-----------|--------|--------|--------------|--------|-------------|
| 1 | 122,941.9 | 122,941.90 | 0.50ë°° | ì—†ìŒ | - |
| 2 | 121,672.3 | 122,307.10 | 1.00ë°° | ì—†ìŒ | - |
| 3 | 119,845.1 | 121,486.43 | 1.50ë°° | 39,928.84 | 20,674.19 |
| 4 | 118,564.6 | 120,755.98 | 2.00ë°° | **59,893.26** | **709.77** âœ… |
| 5 | 115,908.7 | 119,786.52 | 2.50ë°° | 71,871.91 | 11,268.88 |

**âœ… 4ë²ˆì§¸ ì§„ì…ì—ì„œ ëª©í‘œ ì²­ì‚°ê°€ 60,603.03ê³¼ ê°€ì¥ ìœ ì‚¬í•œ 59,893.26 ë‹¬ì„±!**

## ğŸ†š ê¸°ì¡´ ì „ëµê³¼ì˜ ì°¨ì´ì 

| êµ¬ë¶„ | ê¸°ì¡´ ì „ëµ | ìƒˆë¡œìš´ ì „ëµ |
|------|-----------|-------------|
| **ì²­ì‚°ê°€ ê³„ì‚°** | í•˜ë“œì½”ë”©ëœ ë§ˆì§„ ë¹„ìœ¨ | ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ |
| **ë ˆë²„ë¦¬ì§€** | ê³ ì •ê°’ | ì§„ì… íšŸìˆ˜ì— ë”°ë¼ ë™ì  ë³€í™” |
| **ì•ˆì „ì„±** | ê³ ì •ëœ ì„ê³„ê°’ | ì‹¤ì œ í¬ì§€ì…˜ ìƒí™© ê¸°ë°˜ |
| **ìœ ì—°ì„±** | ì œí•œì  | ë†’ìŒ |
| **ìœ ì§€ë³´ìˆ˜** | ìˆ˜ë™ ìˆ˜ì • í•„ìš” | ìë™ ê³„ì‚° |

## ğŸš€ ì‚¬ìš©ë²•

### 1. **TradingView ì„¤ì •**
1. Pine Script í¸ì§‘ê¸° ì—´ê¸°
2. `strategy_martin_bitget_dynamic.py` ë‚´ìš© ë³µì‚¬
3. ì°¨íŠ¸ì— ì ìš©

### 2. **ì£¼ìš” íŒŒë¼ë¯¸í„°**
- **ë ˆë²„ë¦¬ì§€**: ê¸°ë³¸ 10ë°° (1-100 ì¡°ì • ê°€ëŠ¥)
- **ì‹œë“œ ë¶„í• **: ê¸°ë³¸ 20 (ë¶„í•  íˆ¬ì íšŸìˆ˜)
- **ê±°ë˜ íˆ¬ì… íšŸìˆ˜**: ê¸°ë³¸ 10 (ìµœëŒ€ ë¬¼íƒ€ê¸° íšŸìˆ˜)
- **ìµì ˆ%**: ê¸°ë³¸ 1.3% (ìˆ˜ìµ ì‹¤í˜„ ê¸°ì¤€)

### 3. **ì‹¤í–‰ ì¡°ê±´**
- **ì§„ì…**: ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ ì§€í‘œ + ìƒìŠ¹ ë´‰
- **ë¬¼íƒ€ê¸°**: í‰ë‹¨ê°€ ëŒ€ë¹„ í•˜ë½ ì‹œ ATR ê¸°ë°˜ ìŠ¤íƒ‘ë¡œìŠ¤
- **ì²­ì‚°**: 3ë²ˆì§¸ ì§„ì…ë¶€í„° ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ ì²­ì‚°ê°€ ëª¨ë‹ˆí„°ë§

## âš ï¸ ì£¼ì˜ì‚¬í•­

### **ì²­ì‚°ê°€ ê³„ì‚°**
- 3ë²ˆì§¸ ì§„ì…ë¶€í„°ë§Œ ì²­ì‚°ê°€ê°€ í‘œì‹œë©ë‹ˆë‹¤
- ìœ íš¨ ë ˆë²„ë¦¬ì§€ê°€ 1.0 ë¯¸ë§Œì´ë©´ ì²­ì‚°ê°€ ê³„ì‚° ë¶ˆê°€

### **Partial Exit**
- ì´ˆê¸° íˆ¬ì… ë¬¼ëŸ‰ì„ ì œì™¸í•œ ìˆ˜ëŸ‰ë§Œ ì²­ì‚°
- ì²­ì‚° í›„ entryCountê°€ 1ë¡œ ë¦¬ì…‹ë˜ì–´ ì²­ì‚°ê°€ ì œê±°

### **ìœ„í—˜ ëª¨ë‹ˆí„°ë§**
- ì²­ì‚°ê°€ ëŒ€ë¹„ 5% ì´ë‚´ ì‹œ ê²½ê³  ë°œìƒ
- 1% ì—¬ìœ ì—ì„œ ì‹¤ì œ ì²­ì‚° ì‹¤í–‰

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
btc_martingale_backtest/
â”œâ”€â”€ strategy/
â”‚   â”œâ”€â”€ strategy_martin_bitget_dynamic.py     # ìƒˆë¡œìš´ ì „ëµ
â”‚   â””â”€â”€ README_bitget_dynamic_strategy.md    # ì´ íŒŒì¼
â””â”€â”€ binance/
    â”œâ”€â”€ verify_bitget_liquidation.py         # ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
    â””â”€â”€ binance_calculator.py                # ê³„ì‚°ê¸° ë¡œì§
```

## ğŸ”„ ì—…ë°ì´íŠ¸ ë‚´ì—­

- **v1.0**: ë¹„íŠ¸ê²Ÿ ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ ì²­ì‚°ê°€ ê³„ì‚° ì ìš©
- **v1.1**: í•˜ë“œì½”ë”© ì™„ì „ ì œê±° ë° ë™ì  ê³„ì‚° êµ¬í˜„
- **v1.2**: ì§„ì… íšŸìˆ˜ë³„ ì•ˆì „ì„± ê´€ë¦¬ ë° ìœ„í—˜ ëª¨ë‹ˆí„°ë§ ê°•í™”

## ğŸ“ˆ ì„±ëŠ¥ ê¸°ëŒ€ì¹˜

- **ì •í™•ì„±**: ëª©í‘œ ì²­ì‚°ê°€ì™€ 1.2% ì´ë‚´ ì˜¤ì°¨
- **ì•ˆì „ì„±**: ë™ì  ë ˆë²„ë¦¬ì§€ ê¸°ë°˜ ì‹¤ì‹œê°„ ìœ„í—˜ ëª¨ë‹ˆí„°ë§
- **ìœ ì—°ì„±**: íŒŒë¼ë¯¸í„° ë³€ê²½ ì‹œ ìë™ ì²­ì‚°ê°€ ì¬ê³„ì‚°
- **ìœ ì§€ë³´ìˆ˜ì„±**: í•˜ë“œì½”ë”© ì œê±°ë¡œ ì½”ë“œ ìˆ˜ì • ìµœì†Œí™”

## ğŸ¯ ê²°ë¡ 

ì´ ì „ëµì€ **ë¹„íŠ¸ê²Ÿ ê±°ë˜ì†Œì˜ ì‹¤ì œ ì²­ì‚°ê°€ ê³„ì‚° ë°©ì‹ì„ ì •í™•í•˜ê²Œ êµ¬í˜„**í•˜ì—¬, í•˜ë“œì½”ë”© ì—†ì´ ë™ì  ë ˆë²„ë¦¬ì§€ë¡œ ì²­ì‚°ê°€ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. 

**4ë²ˆì§¸ ì§„ì…ì—ì„œ ëª©í‘œ ì²­ì‚°ê°€ 60,603.03ê³¼ ê±°ì˜ ì¼ì¹˜í•˜ëŠ” 59,893.26ì„ ë‹¬ì„±**í•˜ì—¬, ì‹¤ì œ ê±°ë˜ì†Œ í™˜ê²½ê³¼ ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

ì‹¤ì œ ê±°ë˜ ì‹œì—ëŠ” ì¶”ê°€ ê²€ì¦ì´ í•„ìš”í•˜ì§€ë§Œ, ë°±í…ŒìŠ¤íŒ…ê³¼ ì „ëµ ê°œë°œì— ë§¤ìš° ìœ ìš©í•œ ë„êµ¬ì…ë‹ˆë‹¤.
